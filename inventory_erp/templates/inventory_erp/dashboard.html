{% extends "inventory_erp/base.html" %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Stats Overview -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Total Purchases -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-mc-light-grey">Total Purchases</p>
                    <h3 class="text-2xl font-bold text-mc-white">{{ total_purchases }}</h3>
                </div>
                <div class="bg-mc-black/50 p-3 rounded-lg">
                    <i class="fas fa-shopping-cart text-2xl text-mc-accent"></i>
                </div>
            </div>
        </div>

        <!-- Total Sales -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-mc-light-grey">Total Sales</p>
                    <h3 class="text-2xl font-bold text-mc-white">{{ total_sales }}</h3>
                </div>
                <div class="bg-mc-black/50 p-3 rounded-lg">
                    <i class="fas fa-cash-register text-2xl text-mc-accent"></i>
                </div>
            </div>
        </div>

        <!-- Total Dealers -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-mc-light-grey">Active Dealers</p>
                    <h3 class="text-2xl font-bold text-mc-white">{{ total_dealers }}</h3>
                </div>
                <div class="bg-mc-black/50 p-3 rounded-lg">
                    <i class="fas fa-users text-2xl text-mc-accent"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Recent Purchases -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <h2 class="text-lg font-semibold text-mc-white mb-4">Recent Purchases</h2>
            <div class="space-y-4">
                {% for purchase in recent_purchases %}
                <div class="flex items-center justify-between p-3 bg-mc-black/50 rounded-lg">
                    <div>
                        <h4 class="text-mc-white font-medium">{{ purchase.dealer.name }}</h4>
                        <p class="text-sm text-mc-light-grey">Invoice: {{ purchase.dealer_invoice_number }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-mc-white font-medium">${{ purchase.total_amount }}</p>
                        <p class="text-sm text-mc-light-grey">{{ purchase.purchase_date }}</p>
                    </div>
                </div>
                {% empty %}
                <p class="text-mc-light-grey text-center py-4">No recent purchases</p>
                {% endfor %}
            </div>
        </div>

        <!-- Recent Sales -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <h2 class="text-lg font-semibold text-mc-white mb-4">Recent Sales</h2>
            <div class="space-y-4">
                {% for sale in recent_sales %}
                <div class="flex items-center justify-between p-3 bg-mc-black/50 rounded-lg">
                    <div>
                        <h4 class="text-mc-white font-medium">{{ sale.customer_name }}</h4>
                        <p class="text-sm text-mc-light-grey">Invoice: {{ sale.invoice_number }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-mc-white font-medium">${{ sale.final_amount }}</p>
                        <p class="text-sm text-mc-light-grey">{{ sale.sale_date }}</p>
                    </div>
                </div>
                {% empty %}
                <p class="text-mc-light-grey text-center py-4">No recent sales</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Pending Payments -->
    <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
        <h2 class="text-lg font-semibold text-mc-white mb-4">Pending Payments</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full">
                <thead>
                    <tr>
                        <th class="text-left text-mc-light-grey py-2">Dealer</th>
                        <th class="text-left text-mc-light-grey py-2">Type</th>
                        <th class="text-right text-mc-light-grey py-2">Outstanding Amount</th>
                        <th class="text-right text-mc-light-grey py-2">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-mc-grey/30">
                    {% for dealer in pending_payments %}
                    <tr>
                        <td class="py-3 text-mc-white">{{ dealer.name }}</td>
                        <td class="py-3 text-mc-white">{{ dealer.get_dealer_type_display }}</td>
                        <td class="py-3 text-mc-white text-right">${{ dealer.total_pending }}</td>
                        <td class="py-3 text-right">
                            <a href="#" class="text-mc-accent hover:text-mc-white transition-colors">
                                <i class="fas fa-eye mr-1"></i> View Details
                            </a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-mc-light-grey text-center py-4">No pending payments</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
