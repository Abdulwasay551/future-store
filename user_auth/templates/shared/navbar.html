<!-- Navigation -->
 {% load static %}
<nav class="relative top-0 w-full z-10 bg-mc-black/95 backdrop-blur-md border-b border-mc-grey/30">
    <div class="container mx-auto px-6 py-4">
        <div class="flex items-center justify-between">
            <a  hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get='/' class="flex items-center space-x-4">                <div class="w-12 h-12 bg-mc-white rounded-full flex items-center justify-center overflow-hidden">
                    <img src="{% static 'logo-light.JPG' %}" class="w-full h-full object-cover block ">
                </div>
                <div>
                    <h1 class="text-2xl font-bold text-mc-white">Mobile Corner</h1>
                    <p class="text-xs text-mc-light-grey">PEER G</p>
                </div>
            </a>
            
            <!-- Desktop Navigation -->
            <div class="hidden md:flex items-center space-x-8">                
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'home' %}" class="text-mc-white hover:text-mc-accent transition-colors duration-300">Home</a>
                
                <!-- Categories Dropdown -->
                <div class="relative group">
                    <button class="text-mc-white hover:text-mc-accent transition-colors duration-300 flex items-center">
                        Categories <i class="fas fa-chevron-down ml-1"></i>
                    </button>
                    <div class="absolute left-0 z-10 w-56 bg-mc-dark rounded-xl shadow-xl hidden group-hover:block z-20 border border-mc-grey/30">
                        {% for category in categories %}
                        <a hx-get="{% url 'product_list' %}?category={{ category.slug }}"
                           hx-target="#content-comp"
                           hx-push-url="true"
                           class="block px-4 py-2 z-10 text-mc-white hover:bg-mc-grey/30 first:rounded-t-xl last:rounded-b-xl">
                            {{ category.name }}
                        </a>
                        {% endfor %}
                        <div class="border-t border-mc-grey/30"></div>
                        <a hx-get="{% url 'product_list' %}"
                           hx-target="#content-comp"
                           hx-push-url="true"
                           class="block px-4 py-2 text-mc-white hover:bg-mc-grey/30 last:rounded-b-xl">
                            All Products
                        </a>
                    </div>
                </div>

                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'product_list' %}" class="text-mc-white hover:text-mc-accent transition-colors duration-300">Products</a>
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'about' %}" class="text-mc-white hover:text-mc-accent transition-colors duration-300">About</a>
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'contact' %}" class="text-mc-white hover:text-mc-accent transition-colors duration-300">Contact</a>
            </div>

            <div class="flex items-center space-x-4">
                <!-- Theme Toggle -->
                <button id="themeToggle" 
                        class="p-2 text-mc-text hover:bg-mc-grey/20 rounded-lg transition-colors relative group">
                    <i class="fas fa-moon dark:hidden"></i>
                    <i class="fas fa-sun hidden dark:block"></i>
                    <span class="absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 
                               bg-mc-dark text-mc-text px-2 py-1 text-xs rounded-lg opacity-0 
                               group-hover:opacity-100 transition-opacity whitespace-nowrap">
                        Toggle theme
                    </span>
                </button>

                {% if user.is_authenticated %}
                <a hx-get="{% url 'cart_detail' %}" hx-target="#content-comp" hx-push-url="true"
                   class="relative p-2 text-mc-white hover:bg-mc-grey/20 rounded-lg transition-colors">
                    <i class="fas fa-shopping-cart text-lg"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-mc-white text-mc-black text-xs rounded-full w-5 h-5 flex items-center justify-center">
                        {{ request.user.cart_set.first.items.count|default:"0" }}
                    </span>
                </a>
                <!-- Desktop User Menu -->
                <div class="relative group hidden md:block">
                    <button class="flex items-center space-x-2 px-4 py-2 text-mc-white hover:bg-mc-grey/20 rounded-lg transition-colors">
                        <span>{{ user.email }}</span>
                        <i class="fas fa-chevron-down"></i>
                    </button>                    <div class="absolute right-0 w-48 py-2 bg-mc-dark rounded-lg shadow-xl hidden group-hover:block z-20">
                        <a hx-get="{% url 'profile' %}" hx-target="#content-comp" hx-push-url="true"
                           class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                           <i class="fas fa-user mr-2"></i>Profile
                        </a>
                        <a hx-get="{% url 'orders' %}" hx-target="#content-comp" hx-push-url="true"
                           class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                           <i class="fas fa-box mr-2"></i>Orders
                        </a>
                        {% if user.is_staff %}
                        <a href="{% url 'inventory_erp:dashboard' %}" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                            <i class="fas fa-warehouse mr-2"></i>Inventory ERP
                        </a>
                        <a href="{% url 'admin:index' %}" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                            <i class="fas fa-toolbox mr-2"></i>Admin Panel
                        </a>
                        <a href="/admin/cms/" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                            <i class="fas fa-edit mr-2"></i>CMS Admin
                        </a>
                        {% endif %}
                        <hr class="my-2 border-mc-grey">
                        <form action="{% url 'logout' %}" method="POST" class="block">
                            {% csrf_token %}
                            <button type="submit" 
                                    class="w-full text-left px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                                <i class="fas fa-sign-out-alt mr-2"></i>Logout
                            </button>
                        </form>
                    </div>
                </div>
                {% else %}
                <div class="hidden md:flex items-center space-x-4">
                    <a href="{% url 'social:begin' 'google-oauth2' %}" class="px-6 py-2 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors duration-300 font-medium">
                        <i class="fab fa-google mr-2"></i>Login with Google
                    </a>
                    <a hx-get="{% url 'login' %}" hx-target="#content-comp" hx-push-url="true"
                       class="px-6 py-2 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors duration-300 font-medium">
                        Login
                    </a>
                    <a hx-get="{% url 'signup' %}" hx-target="#content-comp" hx-push-url="true"
                       class="px-6 py-2 border border-mc-white text-mc-white rounded-lg hover:bg-mc-grey/20 transition-colors duration-300 font-medium">
                        Sign Up
                    </a>
                </div>
                {% endif %}

                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" 
                        class="md:hidden p-2 text-mc-white hover:bg-mc-grey/20 rounded-lg transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>

        <!-- Mobile Navigation -->
        <div id="mobile-menu" class="hidden md:hidden mt-4 pb-4">
            <div class="flex flex-col space-y-2">
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'home' %}" 
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Home</a>
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'product_list' %}" 
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Products</a>
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'about' %}" 
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">About</a>                
                <a hx-target="#content-comp" hx-swap="innerHTML" hx-push-url="true" hx-get="{% url 'contact' %}" 
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Contact</a>
                
                {% if user.is_authenticated %}
                <hr class="border-mc-grey/30">
                <a hx-get="{% url 'profile' %}" hx-target="#content-comp" hx-push-url="true"
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Profile</a>
                <a hx-get="{% url 'orders' %}" hx-target="#content-comp" hx-push-url="true"
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Orders</a>
                {% if user.is_staff %}
                <a href="{% url 'inventory_erp:dashboard' %}" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                    <i class="fas fa-warehouse mr-2"></i>Inventory ERP
                </a>
                <a href="{% url 'admin:index' %}" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                    <i class="fas fa-toolbox mr-2"></i>Admin Panel
                </a>
                <a href="/admin/cms/" class="block px-4 py-2 text-mc-white hover:bg-mc-grey/20">
                    <i class="fas fa-edit mr-2"></i>CMS Admin
                </a>
                {% endif %}
                <form action="{% url 'logout' %}" method="POST" class="block">
                    {% csrf_token %}
                    <button type="submit" 
                            class="w-full text-left text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">
                        Logout
                    </button>
                </form>
                
                {% else %}
                <hr class="border-mc-grey/30">
                <a href="{% url 'social:begin' 'google-oauth2' %}" class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">
                    <i class="fab fa-google mr-2"></i>Login with Google
                </a>
                <a hx-get="{% url 'login' %}" hx-target="#content-comp" hx-push-url="true"
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Login</a>
                <a hx-get="{% url 'signup' %}" hx-target="#content-comp" hx-push-url="true"
                   onclick="toggleMobileMenu()"
                   class="text-mc-white hover:bg-mc-grey/20 px-4 py-2 rounded-lg">Sign Up</a>
                {% endif %}
            </div>
        </div>
    </div>
</nav>

<script>
function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenu.classList.toggle('hidden');
}

// Theme Toggle Functionality
document.getElementById('themeToggle').addEventListener('click', function() {
    const html = document.documentElement;
    const isDark = html.classList.contains('dark');
    
    // Toggle theme class
    html.classList.toggle('dark');
    
    // Save preference
    localStorage.setItem('theme', isDark ? 'light' : 'dark');
    
    // Update icons
    this.querySelector('.fa-moon').classList.toggle('hidden');
    this.querySelector('.fa-sun').classList.toggle('hidden');
});

// Set initial theme based on preference
document.addEventListener('DOMContentLoaded', function() {
    const theme = localStorage.getItem('theme') || 'dark';
    document.documentElement.classList.toggle('dark', theme === 'dark');
    
    const button = document.getElementById('themeToggle');
    if (theme === 'dark') {
        button.querySelector('.fa-moon').classList.add('hidden');
        button.querySelector('.fa-sun').classList.remove('hidden');
    } else {
        button.querySelector('.fa-moon').classList.remove('hidden');
        button.querySelector('.fa-sun').classList.add('hidden');
    }
});
</script>