{% extends "shared/skeleton.html" %}
{% load static %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-mc-white mb-4">ERP Dashboard</h1>
    </div>

    <!-- Quick Stats -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Inventory Value -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-mc-white font-medium">Inventory Value</h3>
                <i class="fas fa-box text-mc-accent text-xl"></i>
            </div>
            <p class="text-2xl font-bold text-mc-white">${{ total_inventory_value|floatformat:2 }}</p>
            <p class="text-sm text-mc-light-grey">{{ total_products }} Products</p>
        </div>

        <!-- Outstanding Purchases -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-mc-white font-medium">Outstanding Purchases</h3>
                <i class="fas fa-shopping-cart text-mc-accent text-xl"></i>
            </div>
            <p class="text-2xl font-bold text-mc-white">${{ total_outstanding_purchases|floatformat:2 }}</p>
            <p class="text-sm text-mc-light-grey">{{ pending_purchases }} Pending</p>
        </div>

        <!-- Outstanding Sales -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-mc-white font-medium">Outstanding Sales</h3>
                <i class="fas fa-receipt text-mc-accent text-xl"></i>
            </div>
            <p class="text-2xl font-bold text-mc-white">${{ total_outstanding_sales|floatformat:2 }}</p>
            <p class="text-sm text-mc-light-grey">{{ pending_sales }} Pending</p>
        </div>

        <!-- Low Stock Items -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-mc-white font-medium">Low Stock Items</h3>
                <i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>
            </div>
            <p class="text-2xl font-bold text-mc-white">{{ low_stock_count }}</p>
            <p class="text-sm text-mc-light-grey">Products need attention</p>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Recent Purchases -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-mc-white">Recent Purchases</h3>
                <a href="{% url 'admin:store_purchase_changelist' %}" class="text-mc-accent hover:text-mc-white transition-colors">
                    View All
                </a>
            </div>
            <div class="space-y-4">
                {% for purchase in recent_purchases %}
                <div class="flex items-center justify-between p-4 bg-mc-black/50 rounded-lg">
                    <div>
                        <p class="text-mc-white font-medium">{{ purchase.dealer.name }}</p>
                        <p class="text-sm text-mc-light-grey">INV: {{ purchase.invoice_number }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-mc-white font-medium">${{ purchase.total_amount|floatformat:2 }}</p>
                        <p class="text-sm {% if purchase.status == 'pending' %}text-yellow-500{% elif purchase.status == 'received' %}text-green-500{% else %}text-red-500{% endif %}">
                            {{ purchase.get_status_display }}
                        </p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Recent Sales -->
        <div class="bg-mc-dark rounded-xl p-6 border border-mc-grey/30">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-xl font-semibold text-mc-white">Recent Sales</h3>
                <a href="{% url 'admin:store_sale_changelist' %}" class="text-mc-accent hover:text-mc-white transition-colors">
                    View All
                </a>
            </div>
            <div class="space-y-4">
                {% for sale in recent_sales %}
                <div class="flex items-center justify-between p-4 bg-mc-black/50 rounded-lg">
                    <div>
                        <p class="text-mc-white font-medium">{{ sale.customer_name }}</p>
                        <p class="text-sm text-mc-light-grey">INV: {{ sale.invoice_number }}</p>
                    </div>
                    <div class="text-right">
                        <p class="text-mc-white font-medium">${{ sale.final_amount|floatformat:2 }}</p>
                        <p class="text-sm {% if sale.payment_status == 'pending' %}text-yellow-500{% elif sale.payment_status == 'paid' %}text-green-500{% else %}text-blue-500{% endif %}">
                            {{ sale.get_payment_status_display }}
                        </p>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="mt-8 flex flex-wrap gap-4">
        <a href="{% url 'admin:store_purchase_add' %}" 
           class="flex items-center px-6 py-3 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors">
            <i class="fas fa-plus mr-2"></i> New Purchase
        </a>
        <a href="{% url 'admin:store_sale_add' %}"
           class="flex items-center px-6 py-3 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors">
            <i class="fas fa-plus mr-2"></i> New Sale
        </a>
        <a href="{% url 'admin:store_payment_add' %}"
           class="flex items-center px-6 py-3 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors">
            <i class="fas fa-money-bill mr-2"></i> Record Payment
        </a>
        <a href="{% url 'admin:store_deviceidentifier_add' %}"
           class="flex items-center px-6 py-3 bg-mc-white text-mc-black rounded-lg hover:bg-mc-accent transition-colors">
            <i class="fas fa-barcode mr-2"></i> Add Device ID
        </a>
    </div>
</div>
{% endblock %}
